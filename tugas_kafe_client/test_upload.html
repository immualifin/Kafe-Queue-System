<!DOCTYPE html>
<html>
<head>
    <title>Test Upload</title>
</head>
<body>
    <h1>Test Upload Gambar</h1>
    <form id="uploadForm" enctype="multipart/form-data">
        <p>Nama Menu: <input type="text" id="nama_menu" value="Test Browser Upload"></p>
        <p>Harga: <input type="number" id="harga" value="28000"></p>
        <p>Kategori: <input type="number" id="id_kategori" value="3"></p>
        <p>Gambar: <input type="file" id="gambar" accept="image/*"></p>
        <p>Status: <input type="checkbox" id="status_tersedia" checked></p>
        <button type="button" onclick="testUpload()">Upload Test</button>
    </form>

    <div id="result"></div>

    <script>
        async function testUpload() {
            const nama_menu = document.getElementById('nama_menu').value;
            const harga = document.getElementById('harga').value;
            const id_kategori = document.getElementById('id_kategori').value;
            const status_tersedia = document.getElementById('status_tersedia').checked;
            const gambarInput = document.getElementById('gambar');

            const hasFile = gambarInput.files && gambarInput.files.length > 0;

            if (!hasFile) {
                document.getElementById('result').innerHTML = '<p style="color: red;">Pilih file gambar!</p>';
                return;
            }

            const formData = new FormData();
            formData.set('nama_menu', nama_menu);
            formData.set('harga', harga);
            formData.set('id_kategori', id_kategori);
            formData.set('status_tersedia', status_tersedia);
            formData.set('gambar', gambarInput.files[0]);

            console.log('Testing upload...');
            console.log('File:', gambarInput.files[0]);

            try {
                const response = await fetch('http://192.168.1.25/tugas_kafe_server/api/menus/create.php', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                document.getElementById('result').innerHTML = `
                    <h3>Result:</h3>
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                `;

                if (result.success && result.data.gambar) {
                    document.getElementById('result').innerHTML += `
                        <h3>Uploaded Image:</h3>
                        <img src="${result.data.gambar}" style="max-width: 300px;">
                    `;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>